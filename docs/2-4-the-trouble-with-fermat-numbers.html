<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="2.4 The Trouble with Fermat Numbers | Room Squares" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
<meta name="github-repo" content="mhenderson/room" />

<meta name="author" content="Matthew Henderson" />

<meta name="date" content="2019-05-31" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">

<title>2.4 The Trouble with Fermat Numbers | Room Squares</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#kirkmans-schoolgirl-problem"><span class="toc-section-number">1</span> Kirkmanâ€™s Schoolgirl Problem</a><ul>
<li><a href="1-1-tournaments.html#tournaments"><span class="toc-section-number">1.1</span> Tournaments</a></li>
<li><a href="1-2-t-g-room-1902-86.html#t.g.-room-1902-86"><span class="toc-section-number">1.2</span> T.G. Room, (1902-86)</a></li>
<li class="has-sub"><a href="1-3-the-galois-field.html#the-galois-field"><span class="toc-section-number">1.3</span> The Galois Field</a><ul>
<li><a href="1-3-the-galois-field.html#example"><span class="toc-section-number">1.3.1</span> Example</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="2-existence.html#existence"><span class="toc-section-number">2</span> Existence</a><ul>
<li class="has-sub"><a href="2-1-starters-adders-and-cyclic-room-squares.html#starters-adders-and-cyclic-room-squares"><span class="toc-section-number">2.1</span> Starters, Adders and Cyclic Room Squares</a><ul>
<li><a href="2-1-starters-adders-and-cyclic-room-squares.html#finding-a-starter"><span class="toc-section-number">2.1.1</span> Finding a starter</a></li>
<li><a href="2-1-starters-adders-and-cyclic-room-squares.html#finding-an-adder"><span class="toc-section-number">2.1.2</span> Finding an adder</a></li>
</ul></li>
<li><a href="2-2-strong-starters.html#strong-starters"><span class="toc-section-number">2.2</span> Strong Starters</a></li>
<li><a href="2-3-the-mullin-nemeth-starters.html#the-mullin-nemeth-starters"><span class="toc-section-number">2.3</span> The Mullin-Nemeth Starters</a></li>
<li><a href="2-4-the-trouble-with-fermat-numbers.html#the-trouble-with-fermat-numbers"><span class="toc-section-number">2.4</span> The Trouble with Fermat Numbers</a></li>
<li><a href="2-5-a-multiplication-theorem.html#a-multiplication-theorem"><span class="toc-section-number">2.5</span> A Multiplication Theorem</a></li>
<li><a href="2-6-summary.html#summary"><span class="toc-section-number">2.6</span> Summary</a></li>
<li><a href="2-7-n-tuplication-of-room-squares.html#n-tuplication-of-room-squares"><span class="toc-section-number">2.7</span> n-tuplication of Room squares</a></li>
</ul></li>
<li class="has-sub"><a href="3-a-graph-theoretic-approach-to-constructing-room-squares.html#a-graph-theoretic-approach-to-constructing-room-squares"><span class="toc-section-number">3</span> A graph theoretic approach to constructing Room squares</a><ul>
<li><a href="3-1-graph-factorisations.html#graph-factorisations"><span class="toc-section-number">3.1</span> Graph factorisations</a></li>
<li class="has-sub"><a href="3-2-hill-climbing-algorithm-for-room-squares.html#hill-climbing-algorithm-for-room-squares"><span class="toc-section-number">3.2</span> Hill-Climbing Algorithm for Room Squares</a><ul>
<li><a href="3-2-hill-climbing-algorithm-for-room-squares.html#an-algorithm-for-one-factorisations"><span class="toc-section-number">3.2.1</span> An algorithm for One-Factorisations</a></li>
<li><a href="3-2-hill-climbing-algorithm-for-room-squares.html#an-algorithm-for-room-squares"><span class="toc-section-number">3.2.2</span> An Algorithm for Room Squares</a></li>
<li><a href="3-2-hill-climbing-algorithm-for-room-squares.html#the-room-square-generator"><span class="toc-section-number">3.2.3</span> The Room Square Generator</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-balanced-room-squares.html#balanced-room-squares"><span class="toc-section-number">4</span> Balanced Room Squares</a><ul>
<li><a href="4-1-bibds-and-brbs.html#bibds-and-brbs"><span class="toc-section-number">4.1</span> BIBDs and BRBs</a></li>
<li><a href="4-2-complete-balanced-howell-rotations.html#complete-balanced-howell-rotations"><span class="toc-section-number">4.2</span> Complete Balanced Howell Rotations</a></li>
<li><a href="4-3-starters-and-adders-for-brs-and-cbhr.html#starters-and-adders-for-brs-and-cbhr"><span class="toc-section-number">4.3</span> Starters and Adders for BRS and CBHR</a></li>
<li><a href="4-4-a-multiplicative-construction-for-brs.html#a-multiplicative-construction-for-brs"><span class="toc-section-number">4.4</span> A Multiplicative Construction for BRS</a></li>
<li><a href="4-5-symmetric-skew-balanced-starters.html#symmetric-skew-balanced-starters"><span class="toc-section-number">4.5</span> Symmetric Skew Balanced Starters</a></li>
</ul></li>
<li class="has-sub"><a href="5-hill-climbing-for-one-factorisations.html#hill-climbing-for-one-factorisations"><span class="toc-section-number">5</span> Hill-Climbing for One-Factorisations</a><ul>
<li><a href="5-1-one-factors.html#one-factors"><span class="toc-section-number">5.1</span> One-factors</a></li>
<li><a href="5-2-one-factorisations.html#one-factorisations"><span class="toc-section-number">5.2</span> One-factorisations</a></li>
<li class="has-sub"><a href="5-3-heuristics.html#heuristics"><span class="toc-section-number">5.3</span> Heuristics</a><ul>
<li><a href="5-3-heuristics.html#heuristic-h_1"><span class="toc-section-number">5.3.1</span> Heuristic <span class="math inline">\(H_{1}\)</span></a></li>
<li><a href="5-3-heuristics.html#heutistic-h_2"><span class="toc-section-number">5.3.2</span> Heutistic <span class="math inline">\(H_{2}\)</span></a></li>
</ul></li>
<li><a href="5-4-hill-climbing.html#hill-climbing"><span class="toc-section-number">5.4</span> Hill-climbing</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-trouble-with-fermat-numbers" class="section level2">
<h2><span class="header-section-number">2.4</span> The Trouble with Fermat Numbers</h2>
<p>Unfortunately, in establishing the Mullin &amp; Nemeth starters we were
forced to exclude a similarly vast, potentially infinite, class of Room
squares by insisting that <span class="math inline">\(t\)</span> be strictly greater than one. These
exceptional Room squares have side <span class="math inline">\(2^k+1\)</span>.<br />
<br />
Rectifying this problem is essential if we are to prove the existence of
Room squares. As mentioned previously, the proof relies on a
multiplication theorem, so proving that all the â€™primeâ€™ Room squares
exist is vital. Although the theorem of Mullin &amp; Nemeth will take care
of all squares with prime power side, the multiplication theorem is
necessary for proving the existence of those whose side can be
decomposed into prime factors different from each other. In fact, the
multiplication theorem means that we can ignore the Mullin &amp; Nemeth
construction except in the prime case, resorting to multiplication to
recover the prime power squares. Similarly we are only concerned with
recovering the exceptional squares with side <span class="math inline">\(2^k+1\)</span>, when <span class="math inline">\(2^k+1\)</span> is
prime.<br />
<br />
Primes of this form are known as <strong>Fermat Numbers</strong> or <strong>Fermat
Primes</strong>, after Pierre de Fermat who, 360 years ago conjectured that
numbers of the form <span class="math inline">\(2^k+1\)</span> are always prime when <span class="math inline">\(k\)</span> is a power of two.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(F_m=2^{2^m}+1\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(F_0=2^1+1=3\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(F_1=2^2+1=5\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(F_2=2^4+1=17\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(F_3=2^8+1=257\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(F_4=2^{16}+1=65537\)</span></td>
</tr>
</tbody>
</table>
<p>After the first four of Fermatâ€™s numbers, all of which were known to him
to be prime. Nearly one hundred years later Euler calculated the
following, <span class="math display">\[F_5 = 2^{32}+1=4294967297=641\times 6700417\]</span> and in doing
so disproved Fermatâ€™s conjecture.<br />
<br />
Since Eulerâ€™s time, <span class="math inline">\(F_6\)</span>, <span class="math inline">\(F_7\)</span> and <span class="math inline">\(F_8\)</span> have all been factorised[^6]
. It is also known, although most of the factorisations remain unknown,
that <span class="math inline">\(F_m\)</span> is composite for <span class="math inline">\(m=[9...23]\)</span>. <span class="math inline">\(F_{24}\)</span>, a number with over 5
million digits, remains in doubt.<br />
<br />
Whether there be an infinite number of Fermat primes or whether, as
empirically seems to be the case, there are only finitely many (possibly
just five) such primes, in order for the proof of the existence of Room
squares for all odd side greater than 7 to be complete these Fermat
prime Room squares must be included.<br />
<br />
When the problem of Fermat Room squares was tackled first in the early
1970s, W.D.Wallis used a Theorem of J.D.Hortonâ€™s which adapted a famous
result of E.H.Mooreâ€™s from the theory of Steiner triple systems.<br />
<br />
Moore, in 1893, was able to prove that if Steiner triple systems of
orders <span class="math inline">\(v_1\)</span>, <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_3\)</span> exist, where the <span class="math inline">\(v_2\)</span> system is a
sub-system of the <span class="math inline">\(v_3\)</span> system, then an STS of order <span class="math inline">\(v_1(v_2-v_3)+v_3\)</span>
also exists. Horton[12] adapted this result to other combinatorial
objects including Room squares and Wallis[25] was able to use this
Moore-type construction method to include all of the Fermat primes,
except <span class="math inline">\(F_3=257\)</span>[^7] .<br />
<br />
<em>Example 3.5.1</em><br />
If Room squares with side <span class="math inline">\(v_1\)</span>, <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_3\)</span> exist, where the square
of side <span class="math inline">\(v_2\)</span> is a subsquare of the square with side <span class="math inline">\(v_3\)</span>, then a Room
square of side <span class="math inline">\(F_4=65537\)</span> exists. Room squares of side 7 and 11 exist,
according to the theory of Mullin &amp; Nemeth. Applying Hortonâ€™s theorem
once, with <span class="math inline">\(v_3=0\)</span> gives a new square of side <span class="math inline">\(v_1v_2=77\)</span> (note that
Hortonâ€™s theorem reduces to the multiplication theorem when <span class="math inline">\(v_3=0\)</span>).<br />
<br />
The trivial Room square of side one exists, and the Mullin &amp; Nemeth
starters will provide a Room square of size 13. So we can apply Hortonâ€™s
theorem once again to gain a Room square of side 989 because:
<span class="math display">\[989=13(77-1)+1\]</span> Finally we can use Mullin &amp; Nemeth to produce a Room
square of side 67, and a final application of Hortonâ€™s theorem gives:
<span class="math display">\[65537=67(989-11)+11\]</span> The proof of Hortonâ€™s theorem and also an
explanation of Wallisâ€™s application of that theorem to solving the
Fermat prime problem is excluded because another solution was
subsequently found. A year after Wallis had published his solution to
the Fermat problem, Chong and Chan published their (independent)
discovery of the strong starters which are known as the Mullin &amp; Nemeth
starters. Also included in their paper was an alternative solution to
the same problem, but their solution continued to involve the
starter-adder method. This theorem we prove instead.</p>
<div id="theorem-3.5.1-6" class="section level4">
<h4><span class="header-section-number">2.4.0.1</span> Theorem 3.5.1 [6]</h4>
<p><br />
For every Galois field of order <span class="math inline">\((2^{2^m}+1)\)</span>, where <span class="math inline">\(m \geq 2\)</span>, there
exists a Room square of order <span class="math inline">\((2^{2^m}+2)\)</span>.<br />
<br />
<em>Proof</em><br />
The following pairs in <span class="math inline">\(Z_p\)</span> (where <span class="math inline">\(p=2^{2^d}+1\)</span> and <span class="math inline">\(d=2^{m-1})\)</span>
constitute a strong starter.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\{i+(r-1)2^d,i2^d-(r-1\}\)</span></p></li>
<li><p><span class="math inline">\(\{(2^d-i)2^d+r,(2^{d-1}-r)2^d+2^{d-1}-i+1\}\)</span></p></li>
<li><p><span class="math inline">\(\{2^{d-1}+r-1)2^d+2^{d-1}+i,(2^{d-1}+i-1)2^d+2^{d-1}-(r-1)\}\)</span></p></li>
<li><p><span class="math inline">\(\{(2^{d-1}-i)2^d+2^{d-1}+r,(2^d-r+1)2^d-i+1\}\)</span></p></li>
</ol>
<p>Where <span class="math inline">\(1 \leq r \leq 2^{d-2}\)</span> and <span class="math inline">\(1 \leq i \leq 2^{d-1}\)</span>, so rather
than just 4 pairs there are <span class="math inline">\(4 \cdot 2^{d-2} \cdot 2^{d-1}=2^{2d-1}\)</span>
pairs arranged in four different classes. Before completing the proof we
pause for an example just to illustrate the real simplicity of these
apparently complicated pairs.<br />
<br />
<em>Example 3.5.2</em><br />
Suppose <span class="math inline">\(p=2^{2\cdot 2}+1=17=F_2\)</span>, then <span class="math inline">\(d=2^1 \Rightarrow m=2\)</span><br />
<span class="math inline">\(r=1,1 \leq i \leq 2\)</span> and the following pairs should be a strong
starter.<br />
</p>
<p><span>-1.15cm</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left"><span class="math inline">\(i=1,r=1\)</span></th>
<th align="left"><span class="math inline">\(i=2,r=1\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left"><span class="math inline">\(\{1+0 \cdot 2^2,1 \cdot 2^2 - 0\} = \{1,4\}\)</span></td>
<td align="left"><span class="math inline">\(\{2+0 \cdot 2^2,2 \cdot 2^2 -0\} = \{2,8\}\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td align="left"><span class="math inline">\(\{(2^2-1)2^2+1,(2^1-1)2^2+2^1-1+1\}=\{13,6\}\)</span></td>
<td align="left"><span class="math inline">\(\{(2^2-2)2^2+1,(2^1-1)2^2+2^1-2+1\}=\{9,5\}\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left"><span class="math inline">\(\{(2^1+1-1)2^2+2^1+1,(2^1+1-1)2^2+2^1-(1-1)\}\)</span></td>
<td align="left"><span class="math inline">\(\{(2^1+1-1)2^2+2^1+2,(2^1+2-1)2^2+2^1-(1-1)\}\)</span></td>
</tr>
<tr class="even">
<td></td>
<td align="left"><span class="math inline">\(=\{11,10\}\)</span></td>
<td align="left"><span class="math inline">\(=\{12,14\}\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td align="left"><span class="math inline">\(\{(2^1-1)2^2+2^1+1,(2^2-1+1)2^2-1+1\}\)</span></td>
<td align="left"><span class="math inline">\(\{(2^1-2)2^2+2^1+1,(2^2-1+1)2^2-2+1\}\)</span></td>
</tr>
<tr class="even">
<td></td>
<td align="left"><span class="math inline">\(=\{7,16\}\)</span></td>
<td align="left"><span class="math inline">\(=\{3,15\}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Table 4</strong></p>
<p>The pairs generated by this method contain each non-zero member of
<span class="math inline">\(Z_{17}\)</span> exactly once in their union satisfying the first property of a
starter.<br />
The differences are
<span class="math inline">\(\{\pm 3,\pm 7,\pm 1,\pm 8, \pm 6, \pm 4, \pm 2, \pm 5\}=Z_{17} \backslash \{0\}\)</span>,
satisfying the other necessary property of a starter.<br />
The sums 5,2,4,6,10,14,9,1 are all unique, hence the starter is strong
and the set<br />
<span class="math inline">\(\{-5,-2,-4,-6,-10,-14,-9,-1\}=\{12,15,13,11,3,8,16\}\)</span> is an adder. So
the following first row will generate a Room square under cyclic
construction:</p>
<p><span class="math inline">\(\infty,0\)</span> 3,15 13,6 - 11,10 1,4 7,16 - - 12,14 2,8 - - - 9,5 - -
â€”â€”â€”â€” â€”â€” â€”â€” â€” â€”â€”- â€”â€“ â€”â€” â€” â€” â€”â€”- â€”â€“ â€” â€” â€” â€”â€“ â€” â€”</p>
<p>In order to prove that the pairs <span class="math inline">\(1...4\)</span> are a strong starter from any
<span class="math inline">\(Z_p\)</span> we need to prove the following:</p>
<ol style="list-style-type: decimal">
<li><p>The union of all the pairs contains each non-zero member of <span class="math inline">\(Z_p\)</span>
exactly once.</p></li>
<li><p>The differences are all the non-zero members of <span class="math inline">\(Z_p\)</span> exactly once.</p></li>
<li><p>The sums are all distinct and non-zero.</p></li>
</ol>
<p>This is a formidable task, one that would take many pages to prove in
full detail. So instead we sketch an outline of the proof, explicitly
proving a few specific cases.<br />
<br />
First we prove (a) completely.<br />
The non-zero members of <span class="math inline">\(Z_P\)</span>, namely <span class="math inline">\(\{1...2^{2d}\}\)</span>, can be
represented uniquely by:
<span class="math display">\[C(u,v) = u2^d+v \hspace{0.5cm} \mathrm{where} \hspace{0.5cm} 1 \leq v \leq 2^d
\hspace{0.25cm} \mathrm{and} \hspace{0.25cm} 0 \leq u \leq 2^d-1\]</span>
<em>Proof</em><br />
Indeed if <span class="math display">\[u_12^d+v_1=u_22^d+v_2\]</span> then <span class="math display">\[(u_1-u_2)2^d=(v_2-v_1)\]</span> The
RHS takes integer values in the interval <span class="math inline">\([-(2^d-1),2^d-1]\)</span>, which is
symmetric about the origin and smaller than <span class="math inline">\(2^d\)</span> on both sides. Whereas
the LHS takes integer multiple steps of size <span class="math inline">\(2^d\)</span>, so the equality can
only hold in the case when both sides equal zero. Which implies
<span class="math inline">\(u_1=u_2\)</span>, <span class="math inline">\(v_1=v_2\)</span> and <span class="math inline">\(C(u,v)\)</span> is unique representation the non-zero
members of <span class="math inline">\(Z_p\)</span>. <span class="math inline">\(u\)</span> takes <span class="math inline">\(2^d\)</span> values and <span class="math inline">\(v\)</span> takes <span class="math inline">\(2^d\)</span> values so
there are <span class="math inline">\(2^{2d}\)</span> unique non-zero members of <span class="math inline">\(Z_p\)</span> represented in this
way, so each member of <span class="math inline">\(Z_p\)</span> is represented.<br />
The left and right hand members of each pair can be characterised by a
range of values of <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> in the following manner.<br />
Take, for instance, the left hand member of pair 1. <span class="math display">\[i+(r-1)2^d\]</span> Here
<span class="math inline">\(v=i\)</span> and so <span class="math inline">\(1 \leq v \leq 2^{d-1}\)</span>, while <span class="math inline">\(u=(r-1)\)</span>, so
<span class="math inline">\(0 \leq u \leq 2^{d-2}-1\)</span>. The full list of intervals for each member of
each pair is tabulated below.</p>
<table>
<tbody>
<tr class="odd">
<td align="center">Pair</td>
<td align="center">Member</td>
<td align="center"><span class="math inline">\(u\)</span></td>
<td align="center"><span class="math inline">\(V\)</span></td>
</tr>
<tr class="even">
<td align="center">1.</td>
<td align="center">L</td>
<td align="center"><span class="math inline">\([0,2^{d-2}-1]\)</span></td>
<td align="center"><span class="math inline">\([1,2^{d-1}]\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">R</td>
<td align="center"><span class="math inline">\([0,2^{d-1}-1]\)</span></td>
<td align="center"><span class="math inline">\([3 \cdot 2^{d-2}+1,2^{d}]\)</span></td>
</tr>
<tr class="even">
<td align="center">2.</td>
<td align="center">L</td>
<td align="center"><span class="math inline">\([2^{d-1},2^{d}-1]\)</span></td>
<td align="center"><span class="math inline">\([1,2^{d-2}]\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">R</td>
<td align="center"><span class="math inline">\([2^{d-2},2^{d-1}-1]\)</span></td>
<td align="center"><span class="math inline">\([1,2^{d-1}]\)</span></td>
</tr>
<tr class="even">
<td align="center">3.</td>
<td align="center">L</td>
<td align="center"><span class="math inline">\([2^{d-1},3 \cdot 2^{d-2}-1]\)</span></td>
<td align="center"><span class="math inline">\([1+2^{d-1},2^{d}]\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">R</td>
<td align="center"><span class="math inline">\([2^{d-1},2^{d}-1]\)</span></td>
<td align="center"><span class="math inline">\([1+ 2^{d-2},2^{d-1}]\)</span></td>
</tr>
<tr class="even">
<td align="center">4.</td>
<td align="center">L</td>
<td align="center"><span class="math inline">\([0,2^{d-1}-1]\)</span></td>
<td align="center"><span class="math inline">\([1+ 2^{d-1},3 \cdot 2^{d-2}]\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">R</td>
<td align="center"><span class="math inline">\([3 \cdot 2^{d-2},2^{d}-1]\)</span></td>
<td align="center"><span class="math inline">\([1+2^{d-1},2^{d}]\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Table 5</strong></p>
<p>It was mentioned earlier that there were <span class="math inline">\(2^{2d-1}\)</span> pairs, each of which
has two members, so there are <span class="math inline">\(2^{2d}\)</span> elements altogether in the pairs
of the starter, which is the same as the number of elements in <span class="math inline">\(Z_p\)</span>.
Because <span class="math inline">\(C(u,v)\)</span> is a unique representation for each member of <span class="math inline">\(Z_p\)</span>,
for an element of <span class="math inline">\(Z_p\)</span> to occur more than once in the starter requires
repetition of both <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>. This cannot happen because when two
intervals overlap (as they do in the values of <span class="math inline">\(v\)</span> for 1L and 2R).<br />
<br />
To prove (b) we need to show that the differences between two pairs of
type 1 are all unique, similarly between two pairs of types 2,3 and 4.
Moreover we need to show that there can be no repetition in differences
between a pair of type 1 and a pair of type 2, also type 1 with types 3
in 4. Similarly for 2,3 and 4. All together there are ten cases to
prove, tabulated below, where a pair of numbers represents the two types
of pairs from the starter.</p>
<table>
<thead>
<tr class="header">
<th align="left">(i)</th>
<th align="center">11</th>
<th align="left">(ii)</th>
<th align="center">12</th>
<th align="left">(iii)</th>
<th align="center">13</th>
<th align="left">(iv)</th>
<th align="center">14</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(v)</td>
<td align="center">22</td>
<td align="left">(vi)</td>
<td align="center">23</td>
<td align="left">(vii)</td>
<td align="center">24</td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">(viii)</td>
<td align="center">33</td>
<td align="left">(ix)</td>
<td align="center">34</td>
<td align="left"></td>
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">(x)</td>
<td align="center">44</td>
<td align="left"></td>
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><strong>Table 6</strong></p>
<p>To illustrate, we prove (v), in other words that differences ebtween two
different pairs, both of type 2 are always unique.<br />
Type 2 have the form: <span class="math inline">\(\{(2^d-i)2^d+r, (2^{d-1}-r)2^d+2^{d-1}-i+1\}\)</span>.
Therefore, a difference between the elements of a pair of type 2 has the
form: <span class="math display">\[\pm \{(2^d-i)2^d+r-(2^{d-1}-r)2^d-2^{d-1}+i-1\}\]</span> If two
different pairs had the same difference we could write:
<span class="math display">\[(2^d-i)2^d+r-(2^{d-1}-r)2^d-2^{d-1}+i-1
\equiv \pm \{(2^d-j)2^d +s-(2^{d-1}-s)2^d-2^{d-1}+j-1\}(\mathrm{mod} \hspace{0.1cm} p)\]</span>
for some <span class="math inline">\(i \neq j, r \neq s\)</span>. There are two cases to prove, firstly
consider the one involving the + sign.
<span class="math display">\[(2^d-i)2^d+r-(2^{d-1}-r)2^d-2^{d-1}+i-1 \equiv (2^d-j)2^d + s -(2^{d-1}-s)2^d - 2^{d-1} + j -1 (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[\cancel{(2^d}-i)2^d+r-(\cancel{2^{d-1}}-r)2^d-\cancel{2^{d-1}}+i\cancel{-1} \equiv \cancel{(2^d}-j)2^d + s -(\cancel{2^{d-1}}-s)2^d - \cancel{2^{d-1}} + j \cancel{-1} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
In this case we have been helped out with some very convenient
cancelling, leaving just:
<span class="math display">\[-i2^d+r+r \cdot 2^d + i \equiv -j \cdot 2^d + s + s \cdot 2^d + j \hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(-i+j)2^d + i -j \equiv (s-r)(1+2^d) \hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(j-i)(2^d -1) \equiv (s-r)(1+2^d) \hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math inline">\(\times (2^d+1)\)</span>
<span class="math display">\[(j-i)(2^{2d} -1) \equiv (s-r)(1+2 \cdot 2^d + 2^{2d}) \hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math inline">\(2^{2d}+1=p\)</span> <span class="math inline">\(\hspace{0.5cm}\therefore\)</span> <span class="math inline">\(2^{2d}-1 \equiv -2\)</span> (mod <span class="math inline">\(p\)</span>)
<span class="math display">\[-2(j-i)\equiv (s-r)2 \cdot 2^d \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(i-j)\equiv (s-r) 2^d \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p) \hspace{2cm} ...(\mathrm{A})\]</span>
<span class="math inline">\(1 \leq i, j \leq 2^{d-1}\)</span><br />
<span class="math inline">\(\therefore (i-j)\)</span> lies in the interval <span class="math inline">\([-(2^{d-1}-1),2^{d-1}-1]\)</span>,
which is symmetric about the origin, with length
<span class="math inline">\(2 \cdot 2^{d-1}-2=2^d-2 &lt; p = 2^{2d}+1\)</span>.<br />
<span class="math inline">\(1 \leq s,r \leq 2^{d-2}\)</span><br />
<span class="math inline">\(\therefore(s-r)2^d\)</span> lies in the interval
<span class="math inline">\([-(2^{d-2}-1)2^d,(2^{d-2}-1)2^d]\)</span>, again symmetric about the origin
with length <span class="math inline">\(2^{2d}-2^{d+1} &lt; p\)</span>.<br />
So for A to hold requires that <span class="math display">\[(i-j)=(s-r)2^d\]</span> But the LHS has an
interval with length <span class="math inline">\(2^d-2 &lt; 2^d\)</span> whereas the RHS is some positive or
negative integer multiple of <span class="math inline">\(2^d\)</span>, so the two could only be equal when
<span class="math inline">\(i=j,r=s\)</span> contradicting the original hypothesis.<br />
<br />
There is still the negative case to deal with:
<span class="math display">\[(2^d-i)2^d+r-(2^{d-1}-r)2^d-2^{d-1}+i-1 \equiv
-(2^d-j)2^d-s+(2^{d-1}-s)2^d+2^{d-1}-j+1\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(2^d-i)2^d-(2^{d}-j)2^d+i+j \equiv
-s+(2^{d-1}-s)2^d + (2^{d-1} -r)2^d -r + 2 \cdot 2^{d-1} + 2 \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[2 \cdot 2^{2d} + (1-2^{d})(i+j) \equiv
-(s+r)(1+2^d)+2^{2d}+1+2^d+1 \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math inline">\(2^{2d}+1=p \therefore 2^{2d} \equiv -1 \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\)</span>
<span class="math display">\[-2+(1-2^d)(i+j) \equiv -(s+r)(1+2^d)+1+2^d \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(1-2^d)(i+j) \equiv -(s+r)(1+2^d)+3+2^d \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
Now multiply throughout by <span class="math inline">\((1+2^d)\)</span>, noting that:<br />
<span class="math inline">\((1+2^d)(1-2^d) \equiv 2(\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p),(1+2^d)(1+2^d) =1+2 \cdot 2^d + 2^{2d} \equiv 2^{d+1}\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\)</span><br />
and
<span class="math inline">\((1+2^d)(3+2^d)=3+4 \cdot 2^d+2^{2d} \equiv 2^{d+2}+2 \hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\)</span><br />
<span class="math display">\[2(i+j)\equiv -2^{d+1}(s+r)+2^{d+2}+2\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(i+j)\equiv -2^{d}(s+r)+2^{d+1}+1\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[2^d(s+r)\equiv 2 \cdot 2^{d}-(i+j)+1\hspace{0.1cm} (\mathrm{mod} \hspace{0.1cm} p) \hspace{1cm}... (\mathrm{B})\]</span>
<span class="math inline">\(1 \leq s, r \leq 2^{d-2}\)</span><br />
<span class="math inline">\(\therefore 2 \cdot 2^d \leq 2^d(s+r) \leq 2^d2^{d-1}\)</span><br />
The LHS lies in the interval <span class="math inline">\([2^{d+1},2^{2d-1}]\)</span>, which itself is
located somewhere in the interval <span class="math inline">\([0,p]\)</span>.<br />
<span class="math inline">\(1 \leq i, j \leq 2^{d-1}\)</span><br />
<span class="math inline">\(\therefore 2 \leq i + j \leq 2^d\)</span><br />
<span class="math inline">\(2^d \leq 2 \cdot 2^d -(i+j) \leq 2^{d+1} - 2\)</span><br />
So the RHS lies in the interval <span class="math inline">\([2^d+1,2^{d+1}-1]\)</span>, again this is
located with <span class="math inline">\([0,p]\)</span>.<br />
So for B to be satisfied requires that <span class="math display">\[2^d(s+r)=2 \cdot 2^d-(i+j)+1\]</span>
But the RHS and LHS intervals are disjoint so this can never happen.<br />
So the absence of repetition in the differences of two different pairs
both of type 2 is proven. All cases involving different pairs of the
same type are proven in this way {cases (i),(v),(viii),(x)}.<br />
<br />
Finally we demonstrate how the other 6 cases are proven, those involving
pairs of different types.<br />
Inevitably the approach is very similar.<br />
<br />
Consider a pair of type 1 and another pair of type 4 (case iv). If there
were a repetition of differences between pairs of this type we could
write:
<span class="math display">\[i+(r-1)2^d-i2^d+(r-1) \equiv \pm \{(2^{d-1}-j)2^d+2^{d-1}+s-(2^d-s+1)2^d+j-1\}
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span> Consider the + sign,
then
<span class="math display">\[i-i2^d-(2^{d-1}-j)2^d-j \equiv -(r-1)2^d-(r-1)+s-(2^d-s+1)2^d+2^{d-1}-1
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(1-2^d)(i-j)-2^{2d-1} \equiv -(2^d+1)(r-s)-2^{2d}+2^{d-1}
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math inline">\(2^{2d} \equiv -1\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\)</span><br />
<span class="math display">\[(1-2d)(i-j) \equiv -(2^d+1)(r-s)+2^{d-1} + 2^{2d-1} + 1
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span> <span class="math inline">\(\times 2\)</span><br />
<span class="math display">\[2(1-2d)(i-j) \equiv -2(2^d+1)(r-s)+2^{d} + 2^{2d} + 2
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[2(1-2d)(i-j) \equiv -2(2^d+1)(r-s)+2^{d}+1
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span> <span class="math inline">\(\times(2^d+1)\)</span><br />
<span class="math display">\[4(i-j) \equiv -2 \cdot 2^{d+1}(r-s)+2^{d+1}
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[(i-j) \equiv -2^{d}(r-s)+2^{d-1}
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span>
<span class="math display">\[2^d(r-s) \equiv 2^{d-1}-(i-j)
\hspace{0.3cm} (\mathrm{mod} \hspace{0.1cm} p)\]</span> In this instance the
LHS has interval <span class="math inline">\([2^d-2^{2d-2},2^{2d-2}-2^d]\)</span>. while the interval of
the RHS is <span class="math inline">\([1,2^d-1]\)</span>. Both are smaller than <span class="math inline">\(p\)</span> in length, so for
equality requires <span class="math display">\[2^d(r-s) = 2^{d-1}-(i-j)\]</span> But this can never be
true because the left side is always either zero or an integer multiple
of <span class="math inline">\(2^d\)</span>, whereas the interval of the right is <span class="math inline">\([1,2^d-1]\)</span>.<br />
<br />
All other cases are dealt with in a very similar manner, and the proof
of (c), namely that all sums are unique, is not very different.</p>
</div>
</div>
<p style="text-align: center;">
<a href="2-3-the-mullin-nemeth-starters.html"><button class="btn btn-default">Previous</button></a>
<a href="2-5-a-multiplication-theorem.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
